<div ng-controller="RoomController" style="font-family:Arial, sans-serif; color:#333;">

  <!-- Reusable styles (for buttons + popup like Bill) -->
  <style>
    .actions {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .btn-edit {
      padding: 4px 10px;
      background: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }

    .btn-delete {
      padding: 4px 10px;
      background: #E74C3C;
      color: #fff;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }

    .floating-popup {
      position: absolute;
      top: 140px;
      right: 150px;
      width: 360px;
      padding: 20px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 200;
    }

    .floating-popup h4 { margin-top: 0; margin-bottom: 16px; }
    .floating-popup label { display:block; margin-bottom:6px; font-weight:600; }
    .floating-popup input[type="text"],
    .floating-popup input[type="number"] {
      width:100%; padding:8px; border:1px solid #ccc; border-radius:4px; margin-bottom:12px;
    }
  </style>

  <!-- Header + Search + Add Room Button -->
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
    <h3 style="margin:0; color:#2B547D;">Room List</h3>

    <div style="display:flex; align-items:center; gap:10px;">
      <!-- Search Input with Icon -->
      <div style="position:relative;">
        <input type="text" ng-model="searchText" placeholder="Search..." style="padding:6px 30px 6px 10px; border:1px solid #ccc; border-radius:4px; width:200px;">
        <i class="fas fa-search" style="position:absolute; right:8px; top:50%; transform:translateY(-50%); color:#777; cursor:pointer;"
           ng-click="searchFunction()"></i>
      </div>

      <!-- Add Button -->
      <button ng-click="openAddPopup()" style="padding:8px 15px; background:#2B547D; color:#fff; border:none; border-radius:4px; cursor:pointer;">+ Add</button>
    </div>
  </div>

  <!-- Add Room Popup -->
  <div ng-show="showAddPopup" style="position:absolute; top:140px; right:0; width:360px; padding:20px; background:#fff; border:2px solid #2B547D; border-radius:6px; box-shadow:0 4px 12px rgba(0,0,0,0.15); z-index:100;">
    <h4 style="margin-bottom:20px; color:#2B547D;">Add Room</h4>
    <form ng-submit="addRoom()">
      <div style="margin-bottom:12px;">
        <label style="display:block; font-weight:bold; margin-bottom:5px;">Room Number</label>
        <input type="text" ng-model="newRoom.room_number" placeholder="Room Number" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;" required>
      </div>
      <div style="margin-bottom:12px;">
        <label style="display:block; font-weight:bold; margin-bottom:5px;">Room Type</label>
        <input type="text" ng-model="newRoom.room_type" placeholder="Room Type" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;" required>
      </div>
      <div style="margin-bottom:12px;">
        <label style="display:block; font-weight:bold; margin-bottom:5px;">Availability</label>
        <input type="number" ng-model="newRoom.is_available" placeholder="Availability" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;">
      </div>
      <div style="margin-bottom:12px;">
        <label style="display:block; font-weight:bold; margin-bottom:5px;">Price</label>
        <input type="number" ng-model="newRoom.room_price" placeholder="Price" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;">
      </div>
      <div style="text-align:right;">
        <button type="button" ng-click="closeAddPopup()" style="margin-right:8px; padding:6px 12px; border:none; border-radius:4px; background:#7F9DB9; color:#fff; cursor:pointer;">Cancel</button>
        <button type="submit" style="padding:6px 12px; border:none; border-radius:4px; background:#2B547D; color:#fff; cursor:pointer;">Add</button>
      </div>
    </form>
  </div>

  <!-- EDIT ROOM POPUP (like Edit Bill) -->
  <div ng-show="showEditRoomPopup" class="floating-popup" style="border:2px solid #4CAF50;">
    <h4 style="color:#4CAF50;">Edit Room</h4>
    <form ng-submit="updateRoom()">
      <label>Room ID</label>
      <input type="text" ng-model="editRoom.id" readonly>

      <label>Room Number</label>
      <input type="text" ng-model="editRoom.room_number" required>

      <label>Room Type</label>
      <input type="text" ng-model="editRoom.room_type" required>

      <label>Availability</label>
      <input type="number" ng-model="editRoom.is_available">

      <label>Price</label>
      <input type="number" ng-model="editRoom.room_price">

      <div style="text-align:right;">
        <button type="button" ng-click="closeEditRoomPopup()" style="margin-right:8px; padding:6px 12px; border:none; border-radius:4px; background:#7F9DB9; color:#fff; cursor:pointer;">Cancel</button>
        <button type="submit" style="padding:6px 12px; border:none; border-radius:4px; background:#4CAF50; color:#fff; cursor:pointer;">Update</button>
      </div>
    </form>
  </div>

  <!-- Room Table -->
  <div class="table-container" style="margin-top:20px; overflow-x:auto;">
    <table style="width:100%; border-collapse:collapse; table-layout:fixed; border:2px solid #d4cbcb; background:#d4cbcb;">
      <thead>
        <tr style="background:#2B547D; color:#fff; text-align:left;">
          <th style="width:8%; padding:10px; border-right:1px solid #1F3E5B;">Room ID</th>
          <th style="width:20%; padding:10px; border-right:1px solid #1F3E5B;">Room Number</th>
          <th style="width:20%; padding:10px; border-right:1px solid #1F3E5B;">Room Type</th>
          <th style="width:12%; padding:10px; border-right:1px solid #1F3E5B;">Availability</th>
          <th style="width:15%; padding:10px; border-right:1px solid #1F3E5B;">Price</th>
          <th style="width:15%; padding:10px; text-align:center;">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="room in pagedRooms() | filter:searchText" style="border-bottom:1px solid #ccc; background:#fafafa;">
          <td style="padding:8px; border-right:1px solid #ccc;">{{ room.id }}</td>
          <td style="padding:8px; border-right:1px solid #ccc;">{{ room.room_number }}</td>
          <td style="padding:8px; border-right:1px solid #ccc;">{{ room.room_type }}</td>
          <td style="padding:8px; border-right:1px solid #ccc;">{{ room.is_available }}</td>
          <td style="padding:8px; border-right:1px solid #ccc;">{{ room.room_price }}</td>
          <td style="padding:8px;">
            <div class="actions">
              <button class="btn-edit" ng-click="openEditRoomPopup(room)">Edit</button>
              <button class="btn-delete" ng-click="deleteRoom(room.id)">Delete</button>


            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination" style="margin-top:15px; text-align:right;">
      <button ng-disabled="currentPage == 1" ng-click="prevPage()" style="padding:6px 12px; margin-right:5px; border:none; border-radius:4px; background:#2B547D; color:#fff; cursor:pointer;">Prev</button>
      <span style="margin:0 10px; font-weight:bold;">Page {{ currentPage }} of {{ totalPages() }}</span>
      <button ng-disabled="currentPage == totalPages()" ng-click="nextPage()" style="padding:6px 12px; border:none; border-radius:4px; background:#2B547D; color:#fff; cursor:pointer;">Next</button>
    </div>
  </div>

</div>
